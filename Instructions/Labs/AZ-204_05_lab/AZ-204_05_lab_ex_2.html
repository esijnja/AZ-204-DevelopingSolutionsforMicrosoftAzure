<article>
  <h4><a id="user-content-task-1-open-the-cloud-shell-and-editor" class="anchor" aria-hidden="true" href="#task-1-open-the-cloud-shell-and-editor"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 1: Open the Cloud Shell and editor</h4>
  <ol>
  <li>
  <p>Open a new Cloud Shell instance in the Azure portal.</p>
  </li>
  <li>
  <p>At the <strong>Cloud Shell</strong> command prompt, change the active directory to <strong>~/clouddrive</strong>.</p>
  <blockquote>
  <p><strong>Note</strong>: The command to change directory in Bash is <strong>cd <em>path</em></strong>.</p>
  </blockquote>
  </li>
  <li>
  <p>At the <strong>Cloud Shell</strong> command prompt, create a new directory named <strong>ipcheck</strong> in the <strong>~/clouddrive</strong> directory.</p>
  <blockquote>
  <p><strong>Note</strong>: The command to create a new directory in Linux is <strong>mkdir <em>directory name</em></strong>.</p>
  </blockquote>
  </li>
  <li>
  <p>Change the active directory to <strong>~/clouddrive/ipcheck</strong>.</p>
  </li>
  <li>
  <p>Use the <strong>dotnet new console --output . --name ipcheck</strong> command to create a new .NET console application in the current directory.</p>
  </li>
  <li>
  <p>Create a new file in the <strong>~/clouddrive/ipcheck</strong> directory named <strong>Dockerfile</strong>.</p>
  <blockquote>
  <p><strong>Note</strong>: The command to create a new file in Bash is <strong>touch <em>file name</em></strong>. The file name <strong>Dockerfile</strong> is case sensitive.</p>
  </blockquote>
  </li>
  <li>
  <p>Open the embedded graphical editor in the context of the current directory.</p>
  <blockquote>
  <p><strong>Note</strong>: You can open the editor by using the <strong>code .</strong> command or by selecting the editor button.</p>
  </blockquote>
  </li>
  </ol>
  <h4><a id="user-content-task-2-create-and-test-a-net-application" class="anchor" aria-hidden="true" href="#task-2-create-and-test-a-net-application"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 2: Create and test a .NET application</h4>
  <ol>
  <li>
  <p>In the graphical editor, open the <strong>Program.cs</strong> file and replace its contents with the following code, and then save the file:</p>
  <pre><code>public class Program
  {
      public static void Main(string[] args)
      {        
          // Check if network is available
          if (System.Net.NetworkInformation.NetworkInterface.GetIsNetworkAvailable())
          {
              System.Console.WriteLine("Current IP Addresses:");
  
              // Get host entry for current hostname
              string hostname = System.Net.Dns.GetHostName();
              System.Net.IPHostEntry host = System.Net.Dns.GetHostEntry(hostname);
              
              // Iterate over each IP address and render their values
              foreach(System.Net.IPAddress address in host.AddressList)
              {
                  System.Console.WriteLine($"\t{address}");
              }
          }
          else
          {
              System.Console.WriteLine("No Network Connection");
          }
      }
  }
  </code></pre>
  </li>
  <li>
  <p>Use the <strong>dotnet run</strong> command at the command prompt to run the application and validate that it finds one or more IP addresses.</p>
  </li>
  <li>
  <p>Open the <strong>Dockerfile</strong> file in the graphical editor, replace its contents with the following code, and then save the file:</p>
  <pre><code># Start using the .NET Core 2.2 SDK container image
  FROM mcr.microsoft.com/dotnet/core/sdk:2.2-alpine AS build
  
  # Change current working directory
  WORKDIR /app
  
  # Copy existing files from host machine
  COPY . ./
  
  # Publish application to the "out" folder
  RUN dotnet publish --configuration Release --output out
  
  # Start container by running application DLL
  ENTRYPOINT ["dotnet", "out/ipcheck.dll"]
  </code></pre>
  </li>
  <li>
  <p>Close the Cloud Shell pane.</p>
  </li>
  </ol>
  <h4><a id="user-content-task-3-create-a-container-registry-resource" class="anchor" aria-hidden="true" href="#task-3-create-a-container-registry-resource"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 3: Create a Container Registry resource</h4>
  <ul>
  <li>
  <p>Create a new container registry with the following details:</p>
  <ul>
  <li>
  <p>Name: <em><strong>Any globally unique name</strong></em></p>
  </li>
  <li>
  <p>Resource group: <strong>ContainerCompute</strong></p>
  </li>
  <li>
  <p>Location: <strong>East US</strong></p>
  </li>
  <li>
  <p>SKU: <strong>Basic</strong></p>
  </li>
  </ul>
  <blockquote>
  <p><strong>Note</strong>: Wait for the creation task to complete before moving on with this lab.</p>
  </blockquote>
  </li>
  </ul>
  <h4><a id="user-content-task-4-open-azure-cloud-shell-and-store-container-registry-metadata" class="anchor" aria-hidden="true" href="#task-4-open-azure-cloud-shell-and-store-container-registry-metadata"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 4: Open Azure Cloud Shell and store Container Registry metadata</h4>
  <ol>
  <li>
  <p>Open a new Cloud Shell instance.</p>
  </li>
  <li>
  <p>At the <strong>Cloud Shell</strong> command prompt, use the <strong>az acr list</strong> command to get a list of all container registries in your subscription.</p>
  </li>
  <li>
  <p>Use the following command to output the name of the most recently created container registry:</p>
  <pre><code>az acr list --query "max_by([], &amp;creationDate).name" --output tsv
  </code></pre>
  </li>
  <li>
  <p>Use the following command to save the name of the most recently created container registry in a Bash shell variable named <em>acrName</em>:</p>
  <pre><code>acrName=$(az acr list --query "max_by([], &amp;creationDate).name" --output tsv)
  </code></pre>
  </li>
  <li>
  <p>Use the following script to render the value of the Bash shell variable <em>acrName</em>:</p>
  <pre><code>echo $acrName
  </code></pre>
  </li>
  </ol>
  <h4><a id="user-content-task-5-deploy-a-docker-container-image-to-container-registry" class="anchor" aria-hidden="true" href="#task-5-deploy-a-docker-container-image-to-container-registry"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 5: Deploy a Docker container image to Container Registry</h4>
  <ol>
  <li>
  <p>Change the active directory to <strong>~/clouddrive/ipcheck</strong>.</p>
  </li>
  <li>
  <p>Use the <strong>dir</strong> command to get the contents of the current directory.</p>
  <blockquote>
  <p><strong>Note</strong>: You'll know that you're in the correct directory if both the <strong>Program.cs</strong> and <strong>Dockerfile</strong> files that you edited earlier in this lab are there.</p>
  </blockquote>
  </li>
  <li>
  <p>Use the following command to upload the source code to your container registry and build the container image as a  Container Registry task:</p>
  <pre><code>az acr build --registry $acrName --image ipcheck:latest .
  </code></pre>
  <blockquote>
  <p><strong>Note</strong>: Wait for the build task to complete before moving forward with this lab.</p>
  </blockquote>
  </li>
  <li>
  <p>Close the Cloud Shell pane.</p>
  </li>
  </ol>
  <h4><a id="user-content-task-6-validate-your-container-image-in-container-registry" class="anchor" aria-hidden="true" href="#task-6-validate-your-container-image-in-container-registry"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 6: Validate your container image in Container Registry</h4>
  <ol>
  <li>
  <p>Access the container registry that you created earlier in this lab.</p>
  </li>
  <li>
  <p>Select the <strong>Repositories</strong> link to find your images in the registry.</p>
  </li>
  <li>
  <p>Proceed through the <strong>Images</strong> and <strong>Tags</strong> blades to find the metadata associated with the <strong>ipcheck</strong> image with the <strong>latest</strong> tag.</p>
  <blockquote>
  <p><strong>Note</strong>: You can also select the <strong>Run ID</strong> link to find the build task metadata.</p>
  </blockquote>
  </li>
  </ol>
  <h4><a id="user-content-review-1" class="anchor" aria-hidden="true" href="#review-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Review</h4>
  <p>In this exercise, you created a .NET console application to display a machine’s current IP address. You then added the <strong>Dockerfile</strong> file to the application so that it could be converted into a Docker container image. Finally, you deployed the container image to Container Registry.</p>
  </article>