<article>

<h1><a id="user-content-lab-creating-a-multi-tier-solution-by-using-services-in-azure" class="anchor" aria-hidden="true" href="#lab-creating-a-multi-tier-solution-by-using-services-in-azure"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Lab: Creating a multi-tier solution by using services in Azure</h1>
<h1><a id="user-content-student-lab-manual" class="anchor" aria-hidden="true" href="#student-lab-manual"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Student lab manual</h1>
<h2><a id="user-content-lab-scenario" class="anchor" aria-hidden="true" href="#lab-scenario"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Lab scenario</h2>
<p>The developers in your company have successfully adopted and used the <a href="https://httpbin.org/" rel="nofollow">https://httpbin.org/</a> website to test various clients that issue HTTP requests. Your company would like to use one of the publicly available containers on Docker Hub to host the httpbin web application in an enterprise-managed environment with a few caveats. First, developers who are issuing Representational State Transfer (REST) queries should receive standard headers that are used throughout the company's applications. Second, developers should be able to get responses by using JavaScript Object Notation (JSON) even if the API that's used behind the scenes doesn't support the data format. You're tasked with using Microsoft Azure API Management to create a proxy tier in front of the httpbin web application to implement your company's policies.</p>
<h2><a id="user-content-objectives" class="anchor" aria-hidden="true" href="#objectives"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Objectives</h2>
<p>After you complete this lab, you will be able to:</p>
<ul>
<li>
<p>Create a web application from a Docker Hub container image.</p>
</li>
<li>
<p>Create an API Management account.</p>
</li>
<li>
<p>Configure an API as a proxy for another Azure service with header and payload manipulation.</p>
</li>
</ul>
<h2><a id="user-content-lab-setup" class="anchor" aria-hidden="true" href="#lab-setup"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Lab setup</h2>
<ul>
<li>Estimated time: <strong>45 minutes</strong></li>
</ul>
<h2><a id="user-content-instructions" class="anchor" aria-hidden="true" href="#instructions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Instructions</h2>
<h3><a id="user-content-before-you-start" class="anchor" aria-hidden="true" href="#before-you-start"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Before you start</h3>
<p>Make sure the following tools are installed on your machine</p>
<ul>
<li>Microsoft Edge</li>
<li>Windows PowerShell</li>
<li>Visual Studio Code</li>
</ul>
<h3><a id="user-content-make-an-f-drive" class="anchor" aria-hidden="true" href="#make-an-f-drive"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Make an F:\ drive:</h3>
<p>There are two ways to create an F:\ with the content</p>
<ol>
<li>using VHD (virtual hard disk)</li>
<li>using subst (map drive to a directory)</li>
</ol>
<h4><a id="user-content-make-an-f-drive-using-vhd" class="anchor" aria-hidden="true" href="#make-an-f-drive-using-vhd"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Make an F:\ drive using VHD</h4>
<p>In order to create a VHD on Windows 10, do the following:</p>
<ol>
<li>Open Start.</li>
<li>Search for Disk Management and click the top result to launch the experience.</li>
<li>Click the Action button.</li>
<li>Click the Create VHD option.</li>
<li>Click the Browse button and locate the folder you want to store the virtual disk.</li>
<li>In the "File name" field enter a name for the drive.</li>
<li>Use the "Save as type file" drop-down menu and select Virtual Disk files (.vhdx) . Or select Virtual Disk files (.vhd) if you're planning to create a VHD file.</li>
<li>Click the Save button.</li>
<li>Under "Virtual hard disk size," specify the size of the drive in megabytes (MB), gigabytes (GB), or terabytes (TB).</li>
<li>Under "Virtual hard disk format," select the VHDX option. (While using a VHDX format is recommended, you can also select the VHD format, but use it only if required.)</li>
<li>Under "Virtual hard disk type," select the Dynamic expanding option. (If you have selected the VHD format in the previous step, it's recommended to select the Fixed size option when selecting a type.)</li>
<li>Click OK.</li>
</ol>
<p>Once you complete these steps, you'll have created a VHD that you can then set up and use with any compatible version of Windows.</p>
<h5><a id="user-content-how-to-set-up-a-vhdx-or-vhd-on-windows-10" class="anchor" aria-hidden="true" href="#how-to-set-up-a-vhdx-or-vhd-on-windows-10"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How to set up a VHDX or VHD on Windows 10</h5>
<ol>
<li>Using the above steps, you created a VHD, but it's empty without any data or file system. To make it useful, you need to initialize the disk, create a partition, and format the drive using these steps:</li>
<li>Right-click the newly created drive button on the far-left side, and click the Initialize Disk option.</li>
<li>Select the disk from the list.</li>
<li>Check the MBR (Master Boot Record) option. (You could also select the "GPT (GUID Partition Table)" option, but this option isn't supported by all versions of Windows.)</li>
<li>Click OK.</li>
<li>Right-click the Unallocated space, and select the New Simple Volume option.</li>
<li>Click Next.</li>
<li>Specify the size of the partition. (Leave this option unchanged if you're planning to use all the available space for the partition.)</li>
<li>Click Next.</li>
<li>Using the drop-down menu, select the drive letter you want to assign to the drive.</li>
<li>Click Next.</li>
<li>Under the Format this volume with the following settings section, make sure to use the following options:
<ul>
<li>File System - NTFS.</li>
<li>Allocation unit size - Default.</li>
<li>Volume label - Use the name of the drive file, but you can enter any name.</li>
<li>Perform a quick format - Formats the drive faster.</li>
<li>Enable file and folder compression - If it's not required, don't select it (optional).</li>
</ul>
</li>
<li>Click Next.</li>
<li>Click Finish.</li>
</ol>
<p>After completing these steps, the VHDX or VHD will be initialized, partitioned, and formatted.
The VHD will mount automatically, and you can now access and save files using File Explorer.</p>
<h5><a id="user-content-make-sure-to-get-the-labs-source-and-instructions-from" class="anchor" aria-hidden="true" href="#make-sure-to-get-the-labs-source-and-instructions-from"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Make sure to get the labs source and instructions from</h5>
<p><a href="https://github.com/betabitnl/AZ-204-DevelopingSolutionsforMicrosoftAzure">https://github.com/betabitnl/AZ-204-DevelopingSolutionsforMicrosoftAzure</a></p>
<ol>
<li>Click Code</li>
<li>Click download zip</li>
<li>Open zip</li>
<li>Extra All file to F:\</li>
</ol>
<h4><a id="user-content-make-an-f-drive-using-subst" class="anchor" aria-hidden="true" href="#make-an-f-drive-using-subst"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Make an F:\ drive using subst</h4>
<p>By making an F:\ drive using subst it is easier to keep the labs up-to-date with the Github Repo.</p>
<h5><a id="user-content-clone-the-github-repo" class="anchor" aria-hidden="true" href="#clone-the-github-repo"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Clone the github repo:</h5>
<p>In a command prompt goto the direcory where you what to clone the the Github repo into. And type the following command:</p>
<p><code>git clone https://github.com/betabitnl/AZ-204-DevelopingSolutionsforMicrosoftAzure</code></p>
<h5><a id="user-content-create-the-f-drive" class="anchor" aria-hidden="true" href="#create-the-f-drive"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Create the F:\ drive</h5>
<p>For this example the Github is cloned in <code>c:\repos\</code>. To create the F:\ drive with correct content in it, type:</p>
<p><code>subst f: c:\repos\AZ-204-DevelopingSolutionsforMicrosoftAzure</code></p>
<h3><a id="user-content-exercise-1-creating-an-azure-app-service-resource-by-using-a-docker-container-image" class="anchor" aria-hidden="true" href="#exercise-1-creating-an-azure-app-service-resource-by-using-a-docker-container-image"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Exercise 1: Creating an Azure App Service resource by using a Docker container image</h3>
<h4><a id="user-content-task-1-open-the-azure-portal" class="anchor" aria-hidden="true" href="#task-1-open-the-azure-portal"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 1: Open the Azure portal</h4>
<ol>
<li>
<p>Sign in to the Azure portal (<a href="https://portal.azure.com" rel="nofollow">https://portal.azure.com</a>).</p>
</li>
<li>
<p>If this is your first time signing in to the Azure portal, you'll notice a dialog box offering a tour of the portal. Select the <strong>Get Started</strong> button to skip the tour.</p>
</li>
</ol>
<h4><a id="user-content-task-2-create-a-web-app-by-using-azure-app-service-resource-by-using-an-httpbin-container-image" class="anchor" aria-hidden="true" href="#task-2-create-a-web-app-by-using-azure-app-service-resource-by-using-an-httpbin-container-image"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 2: Create a web app by using Azure App Service resource by using an httpbin container image</h4>
<ol>
<li>
<p>Create a new web app with the following details:</p>
<ul>
<li>
<p>New resource group: <strong>ApiService</strong></p>
</li>
<li>
<p>Name: <em><em>httpapi</em>[yourname]</em>**</p>
</li>
<li>
<p>Publish: <strong>Docker Container</strong></p>
</li>
<li>
<p>Operating system: <strong>Linux</strong></p>
</li>
<li>
<p>Region: <strong>West Europe</strong></p>
</li>
<li>
<p>New App Service plan: <strong>ApiPlan</strong></p>
</li>
<li>
<p>SKU and size: <strong>Premium V2 P1v2</strong></p>
</li>
<li>
<p>Docker options: <strong>Single Container</strong></p>
</li>
<li>
<p>Image source: <strong>Docker Hub</strong></p>
</li>
<li>
<p>Access type: <strong>Public</strong></p>
</li>
<li>
<p>Image and tag: <strong>kennethreitz/httpbin:latest</strong></p>
</li>
</ul>
<blockquote>
<p><strong>Note</strong>: Wait for Azure to finish creating the web app before you move forward with the lab. You'll receive a notification when the&nbsp;app&nbsp;is created.</p>
</blockquote>
</li>
</ol>
<h4><a id="user-content-task-3-test-the-httpbin-web-application" class="anchor" aria-hidden="true" href="#task-3-test-the-httpbin-web-application"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 3: Test the httpbin web application</h4>
<ol>
<li>
<p>Access the <em><em>httpapi</em>[yourname]</em>** web app that you created earlier in this lab.</p>
</li>
<li>
<p>Open the <em><em>httpapi</em>[yourname]</em>** web app in your browser.</p>
</li>
<li>
<p>Test the API by selecting the <strong>Response formats</strong> option, selecting <strong>GET /xml</strong>, selecting <strong>Try it out</strong>, and then finally by selecting <strong>Execute</strong>.</p>
</li>
<li>
<p>Observe the response from the HTTP request. Specifically, observe the content of the <strong>Request URL</strong>, <strong>Response body</strong>, and <strong>Response headers</strong> text boxes.</p>
</li>
<li>
<p>Return to the Azure portal and the <strong>Web App</strong> blade for the <em><em>httpapi</em>[yourname]</em>** web app.</p>
</li>
<li>
<p>Access the <strong>Properties</strong> section of the <strong>Web App</strong> blade.</p>
</li>
<li>
<p>In the <strong>Properties</strong> section, record the value of the <strong>URL</strong> text box. You'll use this value later in the lab to make requests against the API.</p>
</li>
</ol>
<h4><a id="user-content-review" class="anchor" aria-hidden="true" href="#review"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Review</h4>
<p>In this exercise, you created a new Azure web app by using a container image sourced from Docker Hub.</p>
<h3><a id="user-content-exercise-2-build-an-api-proxy-tier-by-using-azure-api-management" class="anchor" aria-hidden="true" href="#exercise-2-build-an-api-proxy-tier-by-using-azure-api-management"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Exercise 2: Build an API proxy tier by using Azure API Management</h3>
<h4><a id="user-content-task-1-create-an-api-management-resource" class="anchor" aria-hidden="true" href="#task-1-create-an-api-management-resource"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 1: Create an API Management resource</h4>
<ol>
<li>
<p>In the Azure portal, create a new API Management service instance with the following details:</p>
<ul>
<li>
<p>Existing resource group: <strong>ApiService</strong></p>
</li>
<li>
<p>Name: <em><em>prodapi</em>[yourname]</em>**</p>
</li>
<li>
<p>Location: <strong>West Europe</strong></p>
</li>
<li>
<p>Organization name: <strong>Contoso</strong></p>
</li>
<li>
<p>Pricing tier: <strong>Consumption (99.9 SLA, %)</strong></p>
</li>
</ul>
</li>
</ol>
<h4><a id="user-content-task-2-define-a-new-api" class="anchor" aria-hidden="true" href="#task-2-define-a-new-api"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 2: Define a new API</h4>
<ol>
<li>
<p>Access the <em><em>prodapi</em>[yourname]</em>** API Management service instance that you created earlier in this lab.</p>
</li>
<li>
<p>Create a new <strong>Blank API</strong> with the following details:</p>
<ul>
<li>
<p>Display name: <strong>HTTPBin API</strong></p>
</li>
<li>
<p>Name: <strong>httpbin-api</strong></p>
</li>
<li>
<p>Web service URL: <em>Enter the URL for the web app that you copied earlier in this lab</em></p>
<blockquote>
<p><strong>Note</strong>: Depending on how you copy the URL, you might need to add an "http://" prefix to create a valid URL value.</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>Add a new <strong>operation</strong> to the recently created API with the following details:</p>
<ul>
<li>
<p>Display name: <strong>Echo Headers</strong></p>
</li>
<li>
<p>Name: <strong>echo-headers</strong></p>
</li>
<li>
<p>URL: <strong>GET /</strong></p>
</li>
</ul>
</li>
<li>
<p>Add a new <strong>Set Headers</strong> inbound policy to <strong>All Operations</strong> with the following details:</p>
<ul>
<li>
<p>Name: <strong>source</strong></p>
</li>
<li>
<p>Value: <strong>azure-api-mgmt</strong></p>
</li>
<li>
<p>Action: <strong>append</strong></p>
</li>
</ul>
</li>
<li>
<p>Update the <strong>Backend</strong> for the <strong>Echo Headers</strong> operation by overriding the <strong>Service URL</strong> and appending <strong>/headers</strong> to its current value.</p>
<blockquote>
<p><strong>Note</strong>: For example, if the current value is <strong><a href="http://httpapi*%5Byourname%5D*.azurewebsites.net" rel="nofollow">http://httpapi*[yourname]*.azurewebsites.net</a></strong>, the new value will be <strong><a href="http://httpapi*%5Byourname%5D*.azurewebsites.net/headers" rel="nofollow">http://httpapi*[yourname]*.azurewebsites.net/headers</a></strong></p>
</blockquote>
</li>
<li>
<p>Test the <strong>Echo Headers</strong> operation in the <strong>HTTPBin API</strong>, observing the results of the API request.</p>
<blockquote>
<p><strong>Note</strong>: Observe how there's many headers sent as part of your request that are echoed in the response. Specifically, you'll notice the new <strong>Source</strong> header that you created as part of this task.</p>
</blockquote>
</li>
</ol>
<h4><a id="user-content-task-3-manipulate-an-api-response" class="anchor" aria-hidden="true" href="#task-3-manipulate-an-api-response"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 3: Manipulate an API response</h4>
<ol>
<li>
<p>Add a new <strong>operation</strong> to the API with the following details:</p>
<ul>
<li>
<p>Display name: <strong>Get Legacy Data</strong></p>
</li>
<li>
<p>Name: <strong>get-legacy-data</strong></p>
</li>
<li>
<p>URL: <strong>GET /xml</strong></p>
</li>
</ul>
</li>
<li>
<p>Test the <strong>Get Legacy Data</strong> operation in the <strong>HTTPBin API</strong>, observing the results of the API request.</p>
<blockquote>
<p><strong>Note</strong>: At this point, the results should be in XML format.</p>
</blockquote>
</li>
<li>
<p>Add a new custom outbound policy scoped to the <strong>Get Legacy Data</strong> operation by first locating the following block of XML content:</p>
<pre><code>&lt;outbound&gt;
    &lt;base /&gt;
&lt;/outbound&gt;
</code></pre>
</li>
<li>
<p>Replace that block of XML with the following XML, and then save the policy:</p>
<pre><code>&lt;outbound&gt;
    &lt;base /&gt;
    &lt;xml-to-json kind="direct" apply="always" consider-accept-header="false" /&gt;
&lt;/outbound&gt;
</code></pre>
</li>
<li>
<p>Test the <strong>Get Legacy Data</strong> operation in the <strong>HTTPBin API</strong>, observing the results of the API request.</p>
<blockquote>
<p><strong>Note</strong>: The new results are in JSON format.</p>
</blockquote>
</li>
<li>
<p>Use the <strong>Trace</strong> feature of the test tool to observe the request sent to the back-end service.</p>
</li>
</ol>
<h4><a id="user-content-review-1" class="anchor" aria-hidden="true" href="#review-1"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Review</h4>
<p>In this exercise, you built a proxy tier between your App Service resource and any developers who wish to make queries.</p>
<h3><a id="user-content-exercise-3-clean-up-your-subscription" class="anchor" aria-hidden="true" href="#exercise-3-clean-up-your-subscription"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Exercise 3: Clean up your subscription</h3>
<h4><a id="user-content-task-1-open-azure-cloud-shell" class="anchor" aria-hidden="true" href="#task-1-open-azure-cloud-shell"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 1: Open Azure Cloud Shell</h4>
<ol>
<li>
<p>In the portal, select the <strong>Cloud Shell</strong> icon to open a new shell instance.</p>
</li>
<li>
<p>If Cloud Shell isn't already configured, configure the shell for Bash by using the default settings.</p>
</li>
</ol>
<h4><a id="user-content-task-2-delete-resource-groups" class="anchor" aria-hidden="true" href="#task-2-delete-resource-groups"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 2: Delete resource groups</h4>
<ol>
<li>
<p>Enter the following command, and then select Enter to delete the <strong>ApiService</strong> resource group:</p>
<pre><code>az group delete --name ApiService --no-wait --yes
</code></pre>
</li>
<li>
<p>Close the Cloud Shell pane in the portal.</p>
</li>
</ol>
<h4><a id="user-content-task-3-close-the-active-applications" class="anchor" aria-hidden="true" href="#task-3-close-the-active-applications"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Task 3: Close the active applications</h4>
<ul>
<li>Close the currently running Microsoft Edge application.</li>
</ul>
<h4><a id="user-content-review-2" class="anchor" aria-hidden="true" href="#review-2"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Review</h4>
<p>In this exercise, you cleaned up your subscription by removing the resource groups used in this lab.</p>
</article>